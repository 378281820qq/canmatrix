##**Canmatrix** is a python package to read and write several CAN database formats.##

###About

*Canmatrix* implements a "Python Can Matrix Object" which describes the can-communication and the needed objects (Boardunits, Frames, Signals, Values, ...)
*Canmatrix* also includes two **Tools** (canconvert and cancompare) for converting and comparing **CAN** databases.

There is some outdated german Documentation and windows ".exe" of both scripts at [my personal homepage](http://eduard-broecker.de/Software/canmatrix.html)
There are several importers (read) and exporters (write) for this object.

supported file formats for import:
* .dbc candb / [Vector](http://vector.com)
* .dbf [Busmaster](https://rbei-etas.github.io/busmaster/) (open source!)
* .kcd [kayak](http://kayak.2codeornot2code.org/) (open source!)
* .arxml [autosar](http://autosar.org) system description
* .yaml dump of the python object
* .xls(x) excel xls-import, works with .xls-file generated by this lib
* .sym [peak](http://www.peak-system.com) pcan can description
 
supported file formats for export:
 * .dbc 
 * .dbf
 * .kcd
 * .xls(x)
 * .json [Canard](https://github.com/ericevenchick/CANard) (open source!)
 * .arxml (very basic implementation)
 * yaml (dump of the python object)
 * sym

***

###Install instructions
Install *canmatrix* with either "pip install canmatrix" or  "python setup.py install"

This installs the *canmatrix* package into your python installation.

In addition to the *canmatrix* package there are 2 scripts installed with this package:

1. **canconvert**: 

	converts CAN database formats between all supported formats. 
	
	Example: "*canconvert* someArSystemdescription.arxml file.dbc"
	
2. **cancompare**: 

	compares 2 CAN databases (of different or same format). 
	
	Example: "*cancompare* file1.dbc file2.dbc"
	
If you are using a *NIX-System, these scripts should be callable from command line

If you are using a Windows system, these scripts are usually installed at the location of your python installation. For example 'C:\python3.4\Scripts' or 'C:\python2.7\Scripts'

***

###Dependencies


*Canmatrix* depends on:
 * xlrd ([home](http://www.python-excel.org/), [PyPI](https://pypi.python.org/pypi/xlrd))
 * xlwt-future ([PyPI](https://pypi.python.org/pypi/xlwt-future))
 * XlsxWriter ([GitHub](https://github.com/jmcnamara/XlsxWriter), [PyPI](https://pypi.python.org/pypi/XlsxWriter)
 * PyYAML ([PyPI](https://pypi.python.org/pypi/pyaml))
 * lxml ([PyPI](https://pypi.python.org/pypi/lxml))

***
###Examples

There are some example python scripts in the example-folder

examples/convert.py some-matrix.dbc some-matrix.dbf
examples/convert.py some-matrix.arxml some-matrix.dbc

merge ECU1 (with all frames and attributes) and frame "A_C" of second.dbc into first.dbc and save all together in third.dbc
examples/convert.py --merge second.dbc:ecu=ECU1:frame=A_C first.dbc third.dbc


***

###Fileformats 
* all formats support im-/export of signals and frames

  -h, --help            
			
			show help message and exit

  -v                    
  
  			Output verbosity
  			
  -s                    
  
  			don't print status messages to stdout. (only errors)
  			
  -f FORCE_OUTPUT       
  
  			enforce output format, ignoring output file extension (e.g., -f csv)
                        
  --deleteZeroSignals  
  
  			delete zero length signals (signals with 0 bit length) from matrix default False
                        
  --recalcDLC=RECALCDLC
  
                        recalculate dlc; max: use maximum of stored and calculated dlc; force: force new calculated dlc

  --jsonExportCanard    
  			
  			Export Canard compatible json format
  			
  --ecus=ECUS           
  
  			Copy only given ECUs (comma separated list) to target matrix
  			
  --frames=FRAMES
  			
  			Copy only given Framess (comma separated list) to target matrix
  			
  --merge=MERGE         
  
  			merge additional can databases. Syntax: --merge filename[:ecu=SOMEECU][:frame=FRAME1][:frame=FRAME2],filename2

* dbc: 
  
  --dbcImportEncoding

                        Import charset of dbc (relevant for units), maybe utf-8 default iso-8859-1

  --dbcImportCommentEncoding

                        Import charset of Comments in dbc default iso-8859-1

  --dbcExportEncoding

                        Export charset of dbc (relevant for units), maybe utf-8 default iso-8859-1

  --dbcExportCommentEncoding

                        Export charset of comments in dbc default iso-8859-1
 
  --dbcCharset=CHARSET

                        set charset for dbc-file

  --dbcCommentCharset=CHARSET

                        set charset for comments in dbc-file 

* dbf:

  --dbfImportEncoding

                        Import charset of dbf, maybe utf-8 default iso-8859-1

  --dbfExportEncoding

                        Export charset of dbf, maybe utf-8 default iso-8859-1
* sym:

  --symImportEncoding

                        Import charset of sym format, maybe utf-8 default iso-8859-1

  --symExportEncoding

                        Export charset of sym format, maybe utf-8 default iso-8859-1

* xls(x):

  --xlsMotorolaBitFormat
  
                        Excel format for startbit of motorola coded signals. Valid values: msb, lsb, msbreverse default msbreverse. [more about starbits...](https://github.com/ebroecker/canmatrix/wiki/signal-Byteorder)


 
* arxml:

  --arxmlIgnoreClusterInfo

                        Ignore any can cluster info from arxml; Import all frames in one matrix default 0


* yaml
* json
* kdc
* csv

## Export

|Format|ECUs|Mux  |S/R of Signal|Cycletype|Cycletime|Baudrate |Extended|Byteorder|scaling|min/max|attributes|value tables|signal groups| 
|---|----|----|----------|---------|---------|---------|--------|---------|-------|---|---|---|---|
|arxml |    |+    |		 |         |         |+        |+       |+        |       |       |          |            |             |
|dbc   |+   |+	   |+    	 |+        |+        |         |+       |+        |+      |+      |+         |+           |+            |
|dbf   |+   |+    |+		 |+        |+        |         |+       |+        |+      |+      |+         |+           |            |
|json  |    |	   |		 |         |         |         |        |         |+      |       |          |            |             |
|kcd   |+   |+    |		 |+        |+        |+        |        |         |       |       |          |+           |             |
|sym   |    |+	   |		 |         |         |         |+       |+        |+      |+      |          |+           |             |
|xls(x)|+   |+	   |+		 |+        |+        |         |        |+        |+      |+      |          |+           |             |
|csv |+   |+	   |+		 |+        |+        |         |        |+        |+      |+      |*          |+           |             |



## Import
|Format|ECUs|Mux  |S/R of Signal|Cycletype|Cycletime|Baudrate |Extended|Byteorder|scaling|min/max|attributes|value tables|signal groups| 
|---|----|----|----------|---------|---------|---------|--------|---------|-------|---|---|---|---|
|arxml |+   |+     |+	         |+        |+        |+        |+       |+        |+      |+      |          |+           |+            |
|dbc   |+   |+	   |+    	 |+        |+        |         |+       |+        |+      |+      |+         |+           |+            |
|dbf   |+   |+     |+		 |+        |+        |         |+       |+        |+      |+      |+         |+           |             |
|kcd   |+   |+     |		 |+        |+        |         |        |         |       |       |          |+           |             |
|sym   |    |+	   |		 |         |         |         |+       |+        |+      |+      |          |+           |             |
|xls(x)|+   |+	   |+		 |+        |+        |         |        |+        |p      |p      |          |p           |             |



***


Have Fun,

feel free to contact me for any suggestions

Eduard

